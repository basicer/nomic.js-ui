{"version":3,"sources":["components/MasonView.js"],"names":["encode","target","name","ctx","type","value","$ref","locations","references","exp","JSON","stringify","$v","indexOf","replace","s","$t","props","k","prop","console","log","v","object","computed","property","push","key","test","proto","$s","elements","filter","p","map","properties","f","src","parse","trim","tokens","comment","range","attachComments","comments","body","expression","left","code","operator","right","MasonView","data","React","useMemo","root","go","pop","variant","language","generate"],"mappings":"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","file":"static/js/6.082c2e33.chunk.js","sourcesContent":["import React from \"react\";\nimport {generate, attachComments} from \"escodegen\";\nimport {parse} from \"esprima\";\nimport {Typography} from \"../material\";\nimport Highlight from \"react-highlight.js\";\n\nfunction encode(target, name, ctx) {\n    if (typeof target === \"undefined\") {\n        return {type: 'Identifier', value: 'undefined'};\n    }\n    if (target.$ref) {\n        if (ctx.locations[target.$ref]) return ctx.locations[target.$ref];\n        ctx.locations[target.$ref] = name;\n        return encode(ctx.references[target.$ref], name, ctx);\n    }\n    let exp = { type: \"Literal\", value: JSON.stringify(target) };\n    if (typeof target.$v === \"string\" && target.$v.indexOf(\"\\n\") !== -1) {\n        exp = {\n            \"type\": \"TemplateLiteral\",\n            \"quasis\": [\n                {\n                    \"type\": \"TemplateElement\",\n                    \"value\": {\n                        \"raw\": target.$v.replace(/[`\\\\]/g, (s) => '\\\\' + s),\n                        \"cooked\": target.$v\n                    },\n                    \"tail\": true\n                }\n            ],\n            \"expressions\": []\n        };\n    }\n    else if (typeof target.$v !== \"undefined\") {\n        exp = {\n            type: \"Literal\", value: target.$v\n        };\n    }\n    else if (target.$t === \"object\") {\n        let props = []\n        for ( let k in target.prop ) {\n            console.log(target.prop[k]);\n            let v = encode(target.prop[k].v, {\n                type: 'MemberExpression',\n                object: name,\n                computed: true,\n                property: {type: \"Literal\", value: k}\n            }, ctx);\n            props.push({\n                type: 'Property',\n                computed: false,\n                key: /^[a-zA-Z0-9]*$/.test(k) ? {type: 'Identifier', name: k} : {type: 'Literal', value: k},\n                value: v\n            });\n        }\n        if ( target.proto.$s === '%ArrayPrototype%' ) {\n            exp = {type: 'ArrayExpression', elements: props.filter(p => p.key.value !== \"length\").map(p => p.value) };\n        } else {\n            exp = {type: 'ObjectExpression', properties: props};\n        }\n    }\n    else if (target.$t === \"function\") {\n        let f;\n        if ( target.src ) {\n            f = parse(target.src.trim(), {tokens: true, comment: true, range: true});\n            attachComments(f, f.comments, f.tokens);\n        } else {\n            f = parse(`() => { \"builtin magic\" }`);\n        }\n        if ( f.body[0].expression ) exp = f.body[0].expression;\n        else exp = f.body[0];\n    }\n\n    if (name && name.type === \"Identifier\") {\n        let left = name;\n        if (exp.type === \"FunctionDeclaration\" ) {\n            ctx.code.push(exp);\n        } else {\n            ctx.code.push({\n                type: 'ExpressionStatement',\n                expression: {\n                    type: 'AssignmentExpression',\n                    operator: '=',\n                    left: left,\n                    right: exp\n                }\n            });\n        }\n    }\n    return exp;\n}\n\nexport default function MasonView({data}) {\n    let ctx = React.useMemo(() => {\n        if (!data || !data.root) return;\n        console.log(data);\n        let ctx = {\n            references: data.references,\n            code: [],\n            locations: {\n                [data.root.$ref]: {type: 'Identifier', name: 'global'}\n            }\n        };\n        let go = ctx.references[data.root.$ref];\n        for ( let k in go.prop ) {\n            if (go.prop[k].v.$s) continue;\n            let r = encode(go.prop[k].v, { type: 'Identifier', name: k }, ctx);\n            if (k === 'proposals' || k === \"banner\") {\n                ctx.code.pop();\n            }\n        }\n        return ctx;\n    }, [JSON.stringify(data)]);\n    if (!ctx) return <></>;\n    return (<Typography variant=\"body2\">\n    <Highlight language=\"javascript\">{generate({\n        type: 'Program',\n        body: ctx.code\n    }, { comment: true })}</Highlight></Typography>);\n}"],"sourceRoot":""}